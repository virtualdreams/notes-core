var notes=notes||{};notes=function(e){function t(t){var o=t.serializeArray(),i={};return e.map(o,function(e,t){i[e.name]=e.value}),i}e("[data-toggle=popover]").popover(),e("[data-href]").click(function(){var t=e(this).data("href");location.href=t}),e("#selectAll").click(function(){e("input[name=id][type=checkbox]").prop("checked",function(){return!!e("#selectAll").is(":checked")})}),e("#trashSubmit").click(function(){var t=e("#trash").data("id");e.ajax({type:"POST",url:"/note/remove/"+t}).done(function(){location.href="/"}).fail(function(){e("#error").html('<div class="alert alert-danger">Failed to delete or restore note!</div>')})}),e("#delAccountSubmit").click(function(){var t=e("#delAccount").data("id");e.ajax({type:"POST",url:"/admin/account/delete/"+t}).done(function(t){t.success===!1?e("#error").html('<div class="alert alert-danger">'+t.error+"</div>"):location.href="/admin/account/"}).fail(function(){e("#error").html('<div class="alert alert-danger">Failed to delete account!</div>')})}),e("#saveContinue").click(function(){if(e("#note-form").valid()){var o=t(e("#note-form"));e.ajax({type:"POST",url:"/note/edit/",dataType:"json",data:o}).done(function(t){t.success?(e("#id").val(t.id),e("#result").html('<div class="alert alert-success"><button type="button" class="close">×</button>Note has been successfully saved.</div>'),window.setTimeout(function(){e(".alert").fadeTo(500,0).slideUp(500,function(){e(this).remove()})},5e3),e(".alert .close").on("click",function(t){e(this).parent().fadeTo(500,0).slideUp(500)})):i()}).fail(function(){i()})}var i=function(){e("#result").html('<div class="alert alert-danger"><button type="button" class="close">×</button>Failed to save note!</div>'),e(".alert .close").on("click",function(t){e(this).parent().fadeTo(500,0).slideUp(500)})}}),e("#preview").click(function(){if(e("#note-form").valid())if(e("#editor-source").is(":visible")){var o=t(e("#note-form"));e.ajax({type:"POST",url:"/note/preview/",dataType:"json",data:o}).done(function(t){e("#editor-preview").html(t.content),e("#preview").html('<i class="fa fa-pencil"></i> Edit'),e("#editor-source").toggle(),e("#editor-preview").toggle()})}else e("#preview").html('<i class="fa fa-eye"></i> Preview'),e("#editor-source").toggle(),e("#editor-preview").toggle()}),e("#help").click(function(){e("#editor-help").slideToggle()}),e.validator.setDefaults({highlight:function(t){e(t).closest(".form-group").addClass("has-error")},unhighlight:function(t){e(t).closest(".form-group").removeClass("has-error")}}),e.validator.addMethod("regex",function(e,t,o){return this.optional(t)||e.match(o)},"This field has the wrong format."),e.validator.addMethod("nowhitespace",function(e,t){return this.optional(t)||""!=e.trim()},"This field is required."),e("#login-form").validate({rules:{username:{required:!0,nowhitespace:!0,email:!0},password:{required:!0,nowhitespace:!0,minlength:8}}}),e("#forgot-form").validate({rules:{username:{required:!0,nowhitespace:!0,email:!0}}}),e("#reset-form").validate({rules:{newpassword:{required:!0,nowhitespace:!0,minlength:8},confirmpassword:{required:!0,nowhitespace:!0,minlength:8,equalTo:"#newpassword"}},messages:{confirmpassword:{equalTo:"The passwords doesn't match."}}}),e("#note-form").validate({rules:{title:{required:!0,nowhitespace:!0},content:{required:!0,nowhitespace:!0}}}),e("#settings-form").validate({rules:{items:{required:!0,nowhitespace:!0,min:1,max:100}}}),e("#security-form").validate({rules:{oldpassword:{required:!0,nowhitespace:!0,minlength:8},newpassword:{required:!0,nowhitespace:!0,minlength:8},confirmpassword:{required:!0,nowhitespace:!0,minlength:8,equalTo:"#newpassword"}},messages:{confirmpassword:{equalTo:"The passwords doesn't match."}}}),e("#account-form").validate({rules:{username:{required:!0,email:!0},password:{minlength:8},displayname:{nowhitespace:!0}}})}(jQuery);