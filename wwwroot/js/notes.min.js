var notes=notes||{};notes=function(e){function t(t){var n=t.serializeArray(),o={};return e.map(n,function(e,t){o[e.name]=e.value}),o}e("[data-toggle=popover]").popover(),e("[data-href]").click(function(){var t=e(this).data("href");location.href=t}),e("#selectAll").click(function(){e("input[name=id][type=checkbox]").prop("checked",function(){return!!e("#selectAll").is(":checked")})}),e("#trashSubmit").click(function(){var t=e("#trash").data("id");e.ajax({type:"POST",url:"/note/remove/"+t}).done(function(){location.href="/"}).fail(function(){alert("Failed to delete note.")})}),e("#delAccountSubmit").click(function(){var t=e("#delAccount").data("id");e.ajax({type:"POST",url:"/admin/account/delete/"+t}).done(function(){location.href="/admin/account/"}).fail(function(){alert("Failed to delete account.")})}),e("#saveContinue").click(function(){if(e("#note-form").valid()){var n=t(e("#note-form"));e.ajax({type:"POST",url:"/note/edit/",dataType:"json",data:n}).done(function(t){t.success?(e("#id").val(t.id),e("#result").html('<div class="alert alert-success"><button type="button" class="close">×</button>Successfully saved note!</div>'),window.setTimeout(function(){e(".alert").fadeTo(500,0).slideUp(500,function(){e(this).remove()})},5e3),e(".alert .close").on("click",function(t){e(this).parent().fadeTo(500,0).slideUp(500)})):(e("#result").html('<div class="alert alert-danger"><button type="button" class="close">×</button>Failed to save note!</div>'),e(".alert .close").on("click",function(t){e(this).parent().fadeTo(500,0).slideUp(500)}))}).fail(function(){alert("Failed to save note.")})}}),e("#preview").click(function(){if(e("#note-form").valid())if(e("#editorPane").is(":visible")){var n=t(e("#note-form"));e.ajax({type:"POST",url:"/note/preview/",dataType:"json",data:n}).done(function(t){e("#previewPane").html(t.content),e("#preview").text("Return to edit"),e("#editorPane").toggle(),e("#previewPane").toggle()})}else e("#preview").text("Preview"),e("#editorPane").toggle(),e("#previewPane").toggle()}),e.validator.setDefaults({highlight:function(t){e(t).closest(".form-group").addClass("has-error")},unhighlight:function(t){e(t).closest(".form-group").removeClass("has-error")}}),e.validator.addMethod("regex",function(e,t,n){return this.optional(t)||e.match(n)},"This field has the wrong format."),e.validator.addMethod("nowhitespace",function(e,t){return this.optional(t)||""!=e.trim()},"This field is required."),e("#note-form").validate({rules:{title:{required:!0,nowhitespace:!0},content:{required:!0,nowhitespace:!0}}}),e("#settings-form").validate({rules:{items:{required:!0,nowhitespace:!0,min:1,max:100},language:{required:!0,nowhitespace:!0,regex:"en|de"}}}),e("#security-form").validate({rules:{oldpassword:{required:!0,nowhitespace:!0,minlength:8},newpassword:{required:!0,nowhitespace:!0,minlength:8},confirmpassword:{required:!0,nowhitespace:!0,minlength:8,equalTo:"#newpassword"}}}),e("#account-form").validate({rules:{username:{required:!0,email:!0},password:{minlength:8},displayname:{nowhitespace:!0}}})}(jQuery);